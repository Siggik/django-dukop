{% extends "base.html" %}
{% load i18n sekizai_tags static %}
{% load calendar_tags sorl_thumbnail %}
{% load l10n %}

{% block dukop_title %}{% trans "My locations" %}{% endblock %}


{% block content %}

  <h1>
    {% trans "Locations that you manage" %}
  </h1>

  <p>
    {% trans "Below is the list of locations that you have created or which a group you're in has created." %}
  </p>

  <table class="table">

    <thead>
      <tr>
        <th>{% trans "Name" %}</th>
        <th>{% trans "Event count" %}</th>
        <th>{% trans "Next event" %}</th>
        <th></th>
      </tr>
    </thead>

    <tbody>
      {% for location in locations %}
      <tr>
        <td><a href="{% url "calendar:location_detail" pk=location.id %}">{{ location.name }}</a></td>
        <td>{{ location.events_here.all.count|default:0 }}</td>
        <td>
          {% with location.events_here.all.future.first as next_event%}
            {% if next_event %}
              <a href="{% url "calendar:event_detail" pk=next_event.id %}">{{ next_event.name }}</a>
            {% else %}
              <em>{% trans "No active events" %}</em>
            {% endif %}
          {% endwith %}
        </td>
        <td class="center">
          <a href="{% url "calendar:location_update" pk=location.pk %}" title="Edit" class="button">{% trans "Update" %}<br><div class="icon icon__tool"></div></a>
        </td>
      </tr>
      {% empty %}

      <tr>
        <td colspan="100"><em>{% trans "No locations found" %}</em></td>
      </tr>

      {% endfor %}
    </tbody>

  <tbody>
  </table>

{% endblock %}
